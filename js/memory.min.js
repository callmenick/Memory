!function(a){"use strict";function b(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function c(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function d(a){this.options=b({},this.options),b(this.options,a),this._init()}d.prototype.options={wrapperID:"container",cards:[{id:1,img:"img/default/monsters-01.png"},{id:2,img:"img/default/monsters-02.png"},{id:3,img:"img/default/monsters-03.png"},{id:4,img:"img/default/monsters-04.png"},{id:5,img:"img/default/monsters-05.png"},{id:6,img:"img/default/monsters-06.png"},{id:7,img:"img/default/monsters-07.png"},{id:8,img:"img/default/monsters-08.png"},{id:9,img:"img/default/monsters-09.png"},{id:10,img:"img/default/monsters-10.png"},{id:11,img:"img/default/monsters-11.png"},{id:12,img:"img/default/monsters-12.png"},{id:13,img:"img/default/monsters-13.png"},{id:14,img:"img/default/monsters-14.png"},{id:15,img:"img/default/monsters-15.png"},{id:16,img:"img/default/monsters-16.png"}],onGameStart:function(){return!1},onGameEnd:function(){return!1}},d.prototype._init=function(){this.game=document.createElement("div"),this.game.id="mg",this.game.className="mg",document.getElementById(this.options.wrapperID).appendChild(this.game),this.gameMeta=document.createElement("div"),this.gameMeta.className="mg__meta clearfix",this.gameStartScreen=document.createElement("div"),this.gameStartScreen.id="mg__start-screen",this.gameStartScreen.className="mg__start-screen",this.gameWrapper=document.createElement("div"),this.gameWrapper.id="mg__wrapper",this.gameWrapper.className="mg__wrapper",this.gameContents=document.createElement("div"),this.gameContents.id="mg__contents",this.gameWrapper.appendChild(this.gameContents),this.gameMessages=document.createElement("div"),this.gameMessages.id="mg__onend",this.gameMessages.className="mg__onend",this._setupGame()},d.prototype._setupGame=function(){var a=this;this.gameState=1,this.cards=c(this.options.cards),this.card1="",this.card2="",this.card1id="",this.card2id="",this.card1flipped=!1,this.card2flipped=!1,this.flippedTiles=0,this.chosenLevel="",this.numMoves=0,this.gameMetaHTML='<div class="mg__meta--left">      <span class="mg__meta--level">Nivell:       <span id="mg__meta--level">'+this.chosenLevel+'</span>      </span>      <span class="mg__meta--moves">Moviments:       <span id="mg__meta--moves">'+this.numMoves+'</span>      </span>      </div>      <div class="mg__meta--right">      <button id="mg__button--restart" class="mg__button">Start Over</button>      </div>',this.gameMeta.innerHTML=this.gameMetaHTML,this.game.appendChild(this.gameMeta),this.gameStartScreenHTML='<h2 class="mg__start-screen--heading">Welcome to the Memory Game!</h2>      <p class="mg__start-screen--text">Flip the tiles and try to match them up in pairs. Pair up all the tiles to win. Try to complete the game in as few moves as possible!</p>      <h3 class="mg__start-screen--sub-heading">Select Level</h3>      <ul class="mg__start-screen--level-select">      <li><span data-level="1">Level 1 - Easy (4 x 2)</span></li>      <li><span data-level="2">Level 2 - Medium (6 x 3)</span></li>      <li><span data-level="3">Level 3 - Hard (8 x 4)</span></li>      </ul>',this.gameStartScreen.innerHTML=this.gameStartScreenHTML,this.game.appendChild(this.gameStartScreen),document.getElementById("mg__button--restart").addEventListener("click",function(){a.resetGame()}),this._startScreenEvents()},d.prototype._startScreenEvents=function(){for(var a=this.gameStartScreen.querySelectorAll("ul.mg__start-screen--level-select span"),b=0,c=a.length;c>b;b++){var d=a[b];this._startScreenEventsHandler(d)}},d.prototype._startScreenEventsHandler=function(a){var b=this;a.addEventListener("click",function(){1===b.gameState&&b._setupGameWrapper(this)})},d.prototype._setupGameWrapper=function(a){this.level=a.getAttribute("data-level"),this.gameStartScreen.parentNode.removeChild(this.gameStartScreen),this.gameContents.className="mg__contents mg__level-"+this.level,this.game.appendChild(this.gameWrapper),this.chosenLevel=this.level,document.getElementById("mg__meta--level").innerHTML=this.chosenLevel,this._renderTiles()},d.prototype._renderTiles=function(){this.gridX=2*this.level+2,this.gridY=this.gridX/2,this.numTiles=this.gridX*this.gridY,this.halfNumTiles=this.numTiles/2,this.newCards=[];for(var a=0;a<this.halfNumTiles;a++)this.newCards.push(this.cards[a],this.cards[a]);this.newCards=c(this.newCards),this.tilesHTML="";for(var a=0;a<this.numTiles;a++){var b=a+1;this.tilesHTML+='<div class="mg__tile mg__tile-'+b+'">        <div class="mg__tile--inner" data-id="'+this.newCards[a].id+'">        <span class="mg__tile--outside"></span>        <span class="mg__tile--inside"><img src="'+this.newCards[a].img+'"></span>        </div>        </div>'}this.gameContents.innerHTML=this.tilesHTML,this.gameState=2,this.options.onGameStart(),this._gamePlay()},d.prototype._gamePlay=function(){for(var a=document.querySelectorAll(".mg__tile--inner"),b=0,c=a.length;c>b;b++){var d=a[b];this._gamePlayEvents(d)}},d.prototype._gamePlayEvents=function(a){var b=this;a.addEventListener("click",function(){this.classList.contains("flipped")||(b.card1flipped===!1&&b.card2flipped===!1?(this.classList.add("flipped"),b.card1=this,b.card1id=this.getAttribute("data-id"),b.card1flipped=!0):b.card1flipped===!0&&b.card2flipped===!1&&(this.classList.add("flipped"),b.card2=this,b.card2id=this.getAttribute("data-id"),b.card2flipped=!0,b.card1id==b.card2id?b._gameCardsMatch():b._gameCardsMismatch()))})},d.prototype._gameCardsMatch=function(){var b=this;a.setTimeout(function(){b.card1.classList.add("correct"),b.card2.classList.add("correct")},300),a.setTimeout(function(){b.card1.classList.remove("correct"),b.card2.classList.remove("correct"),b._gameResetVars(),b.flippedTiles=b.flippedTiles+2,b.flippedTiles==b.numTiles&&b._winGame()},1500),this._gameCounterPlusOne()},d.prototype._gameCardsMismatch=function(){var b=this;a.setTimeout(function(){b.card1.classList.remove("flipped"),b.card2.classList.remove("flipped"),b._gameResetVars()},900),this._gameCounterPlusOne()},d.prototype._gameResetVars=function(){this.card1="",this.card2="",this.card1id="",this.card2id="",this.card1flipped=!1,this.card2flipped=!1},d.prototype._gameCounterPlusOne=function(){this.numMoves=this.numMoves+1,this.moveCounterUpdate=document.getElementById("mg__meta--moves").innerHTML=this.numMoves},d.prototype._clearGame=function(){null!==this.gameMeta.parentNode&&this.game.removeChild(this.gameMeta),null!==this.gameStartScreen.parentNode&&this.game.removeChild(this.gameStartScreen),null!==this.gameWrapper.parentNode&&this.game.removeChild(this.gameWrapper),null!==this.gameMessages.parentNode&&this.game.removeChild(this.gameMessages)},d.prototype._winGame=function(){var a=this;this.options.onGameEnd()===!1?(this._clearGame(),this.gameMessages.innerHTML='<h2 class="mg__onend--heading">Sweet!</h2>        <p class="mg__onend--message">You won the round in '+this.numMoves+' moves. Go you.</p>        <button id="mg__onend--restart" class="mg__button">Play again?</button>',this.game.appendChild(this.gameMessages),document.getElementById("mg__onend--restart").addEventListener("click",function(){a.resetGame()})):this.options.onGameEnd()},d.prototype.resetGame=function(){this._clearGame(),this._setupGame()},a.Memory=d}(window);